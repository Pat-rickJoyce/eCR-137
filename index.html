<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eICR Form Generator - DQ Schematron Compliant</title>
    <style>
        /* Base overrides to bridge standard CDA structure with Clean UI v8.1 */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .section {
            margin: 0 0 30px 0;
        }

        .patient-overview-card {
            background:
                radial-gradient(at 0% 0%, rgba(99, 102, 241, 0.05) 0%, transparent 50%),
                radial-gradient(at 100% 100%, rgba(139, 92, 246, 0.05) 0%, transparent 50%),
                #ffffff;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            border-radius: 32px;
            box-shadow:
                0 4px 6px -1px rgba(0, 0, 0, 0.05),
                0 20px 40px -4px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            padding: 28px 40px;
            margin: 0 20px 30px 20px;
            display: flex;
            align-items: center;
            gap: 32px;
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .snapshot-label {
            font-size: 10px;
            font-weight: 800;
            color: var(--muted);
            letter-spacing: 0.15em;
            text-transform: uppercase;
            margin-bottom: 4px;
            display: block;
            opacity: 0.8;
        }

        .patient-overview-card:hover {
            transform: translateY(-2px);
            box-shadow:
                0 4px 6px -1px rgba(0, 0, 0, 0.05),
                0 25px 50px -12px rgba(0, 0, 0, 0.15);
        }

        /* Ambient glow in the corner */
        .patient-overview-card::after {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(99, 102, 241, 0.08) 0%, transparent 70%);
            z-index: 0;
            pointer-events: none;
        }

        .patient-overview-card .patient-avatar {
            width: 76px;
            height: 76px;
            border-radius: 24px;
            background: var(--accent-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 32px;
            font-weight: 800;
            flex-shrink: 0;
            box-shadow:
                0 0 0 4px rgba(99, 102, 241, 0.1),
                0 10px 25px rgba(99, 102, 241, 0.35),
                inset 0 1px 1px rgba(255, 255, 255, 0.5);
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .patient-overview-card .patient-avatar i {
            display: none;
            /* Initially hide icon if using initials */
        }

        .patient-overview-card .patient-info {
            flex: 1;
            position: relative;
            z-index: 1;
        }

        .patient-overview-card .patient-name {
            font-size: 1.85rem;
            font-weight: 800;
            color: var(--text);
            margin: 0;
            letter-spacing: -0.03em;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .patient-overview-card .patient-meta {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .patient-overview-card .meta-chip {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #ffffff;
            border: 1px solid #e2e8f0;
            padding: 6px 14px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            color: #475569;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            transition: all 0.2s ease;
        }

        .patient-overview-card .meta-chip:hover {
            border-color: var(--accent);
            color: var(--accent);
            transform: translateY(-1px);
        }

        .patient-overview-card .meta-chip i {
            color: #94a3b8;
            font-size: 0.8rem;
        }

        .patient-overview-card .record-badge {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 4px;
        }

        .patient-overview-card .status-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 11px;
            font-weight: 700;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .patient-overview-card .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #10b981;
            box-shadow: 0 0 10px #10b981;
            animation: pulse-green 2s infinite;
        }

        @keyframes pulse-green {
            0% {
                box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);
            }

            70% {
                box-shadow: 0 0 0 10px rgba(16, 185, 129, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(16, 185, 129, 0);
            }
        }

        .trigger-indicator {
            background: var(--accent-weak);
            color: var(--accent);
            padding: 2px 8px;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-left: 8px;
            border: 1px solid rgba(99, 102, 241, 0.2);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .input-group label {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--muted);
            padding-left: 4px;
        }

        .input-group span.required {
            color: var(--warning);
            margin-left: 2px;
        }

        .textarea-group {
            grid-column: 1 / -1;
        }

        @media (max-width: 768px) {
            .header-premium {
                flex-direction: column;
                align-items: flex-start;
                gap: 24px;
            }
        }

        .patient-overview-card .meta-chip.clinical-count {
            border-style: dashed;
            font-weight: 700;
        }

        .patient-overview-card .meta-chip.clinical-count:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        /* ========================================
           MEDICATION ADMINISTERED EVIDENCE ROW STYLING
           ======================================== */
        .medication-administered-evidence-row,
        .diagnosis-evidence-row,
        .problem-evidence-row,
        .lab-evidence-row,
        .medication-evidence-row,
        .immunization-row,
        .procedure-row {
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--border);
            border-left: 4px solid var(--accent);
            border-radius: var(--radius);
            box-shadow: var(--shadow-md);
            padding: 24px;
            margin: 20px 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            animation: fadeInDown 0.4s ease-out;
        }

        .medication-administered-evidence-row:hover,
        .diagnosis-evidence-row:hover,
        .problem-evidence-row:hover,
        .lab-evidence-row:hover,
        .medication-evidence-row:hover,
        .immunization-row:hover,
        .procedure-row:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-left-color: #8b5cf6;
        }

        .medication-administered-evidence-row h4,
        .diagnosis-evidence-row h4,
        .problem-evidence-row h4,
        .lab-evidence-row h4,
        .medication-evidence-row h4 {
            margin: 0 0 20px 0;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border);
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .medication-administered-evidence-row h4::before,
        .diagnosis-evidence-row h4::before,
        .problem-evidence-row h4::before,
        .lab-evidence-row h4::before,
        .medication-evidence-row h4::before {
            content: "üìã";
            font-size: 1.3rem;
        }

        .medication-administered-evidence-controls,
        .diagnosis-evidence-controls,
        .problem-evidence-controls,
        .lab-evidence-controls {
            margin: 20px 0;
        }

        /* Code search styling */
        .code-search {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .code-search input {
            flex: 1;
        }

        .code-search .btn {
            flex-shrink: 0;
            padding: 10px 16px !important;
        }

        .search-results {
            margin-top: 8px;
            max-height: 300px;
            overflow-y: auto;
            border-radius: var(--radius-sm);
            display: none;
        }

        .search-results-list {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            box-shadow: var(--shadow-md);
        }

        .search-result-item {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        .search-result-item:hover {
            background: var(--accent-weak);
            color: var(--accent);
        }

        .no-results {
            padding: 12px 16px;
            text-align: center;
            color: var(--muted);
            font-style: italic;
        }

        .hidden {
            display: none !important;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>


    <!-- Clean UI v8.1 styles -->
    <link rel="stylesheet" href="css/styles.css">

</head>

<body>
    <div class="ui81-watermark"></div>
    <div class="ui81-brand">
        <img src="./assets/images/penguin-logo.png" alt="eCeleRate" class="penguin-logo">
        <div class="name">eCeleRate</div>
    </div>

    <!-- Patient Demographics Overview -->
    <div class="patient-overview-card">
        <div class="patient-avatar" id="patientAvatarInitials">P</div>
        <div class="patient-info">
            <span class="snapshot-label">Patient Snapshot</span>
            <h1 class="patient-name" id="patientOverviewName" style="margin-bottom: 12px;">
                <span id="patientNameText">Patient Name</span>
            </h1>

            <!-- Main Demographics Row -->
            <div class="patient-meta" style="margin-bottom: 16px;">
                <div class="meta-chip">
                    <i class="fas fa-calendar-alt"></i>
                    <span id="patientOverviewDOB">DOB: 06/15/2024</span>
                </div>
                <div class="meta-chip">
                    <i class="fas fa-venus-mars"></i>
                    <span id="patientOverviewGender">Female</span>
                </div>
                <div class="meta-chip">
                    <i class="fas fa-users"></i>
                    <span id="patientOverviewRace">White</span>
                </div>
                <div class="meta-chip">
                    <i class="fas fa-globe"></i>
                    <span id="patientOverviewEthnicity">Non-Hispanic</span>
                </div>
            </div>

            <!-- Clinical Counts Row -->
            <div class="patient-meta">
                <div class="meta-chip clinical-count"
                    style="border-color: #fecaca; background: #fef2f2; color: #991b1b;">
                    <i class="fas fa-file-medical-alt" style="color: #ef4444;"></i>
                    <span id="patientOverviewDiagCount">0 Diagnoses</span>
                </div>
                <div class="meta-chip clinical-count"
                    style="border-color: #fde68a; background: #fffbeb; color: #92400e;">
                    <i class="fas fa-exclamation-triangle" style="color: #f59e0b;"></i>
                    <span id="patientOverviewProbCount">0 Problems</span>
                </div>
                <div class="meta-chip clinical-count"
                    style="border-color: #bfdbfe; background: #eff6ff; color: #1e40af;">
                    <i class="fas fa-vials" style="color: #3b82f6;"></i>
                    <span id="patientOverviewLabCount">0 Labs</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden functional gateway buttons - User now uses the floating dock as requested -->
    <div style="display:none !important;">
        <button class="ui81-btn" onclick="saveFormData()"><i class="fas fa-save"></i> Save Data</button>
        <button class="ui81-btn secondary" onclick="downloadZipOfEICRandRR()"><i
                class="fas fa-file-archive"></i> Package ZIP</button>
        <button id="generate-cda-btn" onclick="generateAndDownloadCDA()">Generate CDA</button>
        <button id="generate-rr-btn" onclick="generateAndDownloadRR()">Generate RR</button>
        <button id="zip-btn" onclick="downloadZipOfEICRandRR()">Download ZIP (eICR + RR)</button>
        <button onclick="loadFormDataDialog()">Load Form Data</button>
        <button onclick="saveFormData()">Save Form Data</button>
        <input type="file" id="loadFormDataInput" accept=".json" onchange="loadFormData(event)">
    </div>

    <!-- Safety container for validation errors (JS looks for .footer-buttons or #validation-errors) -->
    <div id="validation-errors" style="display:none;"></div>
    <div class="footer-buttons" style="display:none !important;"></div>

    <div class="section">
        <h2 class="section-title"><i class="fas fa-user"></i> Patient Demographics</h2>
        <div class="form-grid">
            <div class="input-group">
                <label>Patient ID <span class="help-tooltip"
                        title="Unique identifier that stays the same across all versions of the same logical document. Documents with the same Set ID represent different versions of the same document.">‚ÑπÔ∏è</span></label>
                <input type="text" id="patientId" value="MRN-00234567">
            </div>
            <div class="input-group">
                <label>Patient Name <span style="color: red;">*</span></label>
                <input type="text" id="patientName" value="Emma Rose Johnson" required>
            </div>
            <div class="input-group">
                <label>Phone</label>
                <input type="text" id="patientPhone" value="+1-555-234-5678">
            </div>
            <div class="input-group">
                <label>Email</label>
                <input type="email" id="patientEmail" value="johnson.family@email.com">
            </div>
            <div class="input-group">
                <label>Address <span style="color: red;">*</span></label>
                <input type="text" id="patientAddress" value="1247 Maple Street" required>
            </div>
            <div class="input-group">
                <label>City <span style="color: red;">*</span></label>
                <input type="text" id="patientCity" value="Springfield" required>
            </div>
            <div class="input-group">
                <label>State <span style="color: red;">*</span></label>
                <input type="text" id="patientState" value="IL" required>
            </div>
            <div class="input-group">
                <label>ZIP Code <span style="color: red;">*</span></label>
                <input type="text" id="patientZip" value="62701" required>
            </div>
            <div class="input-group">
                <label>County</label>
                <input type="text" id="patientCounty" value="Sangamon County">
            </div>
            <div class="input-group">
                <label>Country</label>
                <input type="text" id="patientCountry" value="US">
            </div>
            <div class="input-group">
                <label>Administrative Gender Code <span style="color: red;">*</span></label>
                <select id="patientGender" required>
                    <option value="">Select Gender</option>
                    <option value="F" selected>Female</option>
                    <option value="M">Male</option>
                    <option value="UN">Undifferentiated</option>
                </select>
            </div>
            <div class="input-group">
                <label>Birth Date</label>
                <input type="datetime-local" id="patientBirthDate" value="2024-06-15T00:00">
            </div>
            <div class="input-group">
                <label>Race Code <span style="color: red;">*</span></label>
                <select id="patientRace" required>
                    <option value="">Select Race</option>
                    <option value="1002-5">American Indian or Alaska Native</option>
                    <option value="2028-9">Asian</option>
                    <option value="2054-5">Black or African American</option>
                    <option value="2076-8">Native Hawaiian or Other Pacific Islander</option>
                    <option value="2106-3" selected>White</option>
                    <option value="2131-1">Other Race</option>
                    <option value="UNK">Unknown</option>
                </select>
            </div>
            <div class="input-group">
                <label>Ethnicity Code <span style="color: red;">*</span></label>
                <select id="patientEthnicity" required>
                    <option value="">Select Ethnicity</option>
                    <option value="2135-2">Hispanic or Latino</option>
                    <option value="2186-5" selected>Not Hispanic or Latino</option>
                    <option value="UNK">Unknown</option>
                </select>
            </div>
            <div class="input-group">
                <label>Birth Place City</label>
                <input type="text" id="patientBirthPlaceCity" value="Springfield">
            </div>
            <div class="input-group">
                <label>Birth Place State</label>
                <input type="text" id="patientBirthPlaceState" value="IL">
            </div>
            <div class="input-group">
                <label>Birth Place Country</label>
                <input type="text" id="patientBirthPlaceCountry" value="US">
            </div>
            <div class="input-group">
                <label>Birth Place Facility</label>
                <input type="text" id="patientBirthPlaceFacility" value="Memorial Hospital">
            </div>
            <div class="input-group">
                <label>Birth Sex</label>
                <select id="patientBirthSex">
                    <option value="F">Female</option>
                    <option value="M">Male</option>
                    <option value="UNK">Unknown</option>
                </select>
            </div>
            <div class="input-group" style="display:none">
                <label>Gender Identity</label>
                <select id="patientGenderIdentity">
                    <option value="446151000124109">Identifies as female gender (finding)</option>
                    <option value="446141000124107">Identifies as male gender (finding)</option>
                    <option value="33791000087105">Identifies as nonbinary gender (finding)</option>
                    <option value="UNK">Unknown</option>
                </select>
            </div>
            <div class="input-group">
                <label>Detailed Race Code</label>
                <select id="patientDetailedRace">
                    <option value="1004-1">American Indian</option>
                    <option value="1010-8">Alaska Native</option>
                    <option value="2029-7">Asian Indian</option>
                    <option value="2040-4">Chinese</option>
                    <option value="2047-9">Filipino</option>
                    <option value="2051-1">Japanese</option>
                    <option value="2054-5">Korean</option>
                    <option value="2058-6">Vietnamese</option>
                    <option value="2060-2">Other Asian</option>
                    <option value="2076-8">Black</option>
                    <option value="2108-9" selected>White</option>
                    <option value="2131-1">Other</option>
                </select>
            </div>
            <div class="input-group">
                <label>Detailed Ethnicity Code</label>
                <select id="patientDetailedEthnicity">
                    <option value="2137-8">Mexican</option>
                    <option value="2141-0">Puerto Rican</option>
                    <option value="2142-8">Cuban</option>
                    <option value="2148-5" selected>Not Hispanic or Latino</option>
                    <option value="2180-8">Other Hispanic or Latino</option>
                </select>
            </div>
            <div class="input-group">
                <label>Primary Language</label>
                <input type="text" id="patientLanguage" value="en">
            </div>
            <div class="input-group">
                <label>Death Indicator</label>
                <select id="patientDeathIndicator">
                    <option value="false">No</option>
                    <option value="true">Yes</option>
                </select>
            </div>
            <div class="input-group">
                <label>Date of Death (YYYYMMDD)</label>
                <input type="datetime-local" id="patientDeathDate" placeholder="Leave blank if alive">
            </div>
            <div class="input-group">
                <label>Disability Status</label>
                <select id="disabilityStatus">
                    <option value="21134002" selected>Disabled</option>
                    <option value="405159006">Not disabled</option>
                    <option value="261665006">Unknown</option>
                </select>
            </div>
            <div class="input-group">
                <label>Disability Type</label>
                <input type="text" id="disabilityType" value="Spina bifida - congenital neural tube defect">
            </div>
            <div class="input-group">
                <label>Tribal Affiliation</label>
                <input type="text" id="tribalAffiliation" value="Not applicable">
            </div>
            <div class="input-group">
                <label>Tribal Enrollment</label>
                <select id="tribalEnrollment">
                    <option value="true">Yes</option>
                    <option value="false" selected>No</option>
                    <option value="UNK">Unknown</option>
                </select>
            </div>
            <div class="input-group">
                <label>Immigration Status</label>
                <select id="immigrationStatus">
                    <option value="160542002" selected>US Citizen</option>
                    <option value="160540005">Permanent Resident</option>
                    <option value="160541006">Temporary Resident</option>
                    <option value="160543007">Undocumented</option>
                    <option value="261665006">Unknown</option>
                </select>
            </div>
            <div class="input-group">
                <label>Preferred Language</label>
                <input type="text" id="preferredLanguage" value="English">
            </div>
            <div class="input-group">
                <label>Interpreter Needed</label>
                <select id="interpreterNeeded">
                    <option value="Y">Yes</option>
                    <option value="N" selected>No</option>
                    <option value="UNK">Unknown</option>
                </select>
            </div>
            <div class="input-group">
                <label>Insurance Status</label>
                <select id="insuranceStatus">
                    <option value="48758009" selected>Insured</option>
                    <option value="182890002">Uninsured</option>
                    <option value="182891003">Self-pay</option>
                    <option value="261665006">Unknown</option>
                </select>
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-title"><i class="fas fa-briefcase"></i> Occupation Information</h2>
        <div class="form-grid">
            <div class="input-group">
                <label>Current Occupation</label>
                <input type="text" id="currentOccupation" placeholder="Marketing Manager">
            </div>
            <div class="input-group">
                <label>Usual Occupation</label>
                <input type="text" id="usualOccupation" placeholder="Marketing Manager">
            </div>
            <div class="input-group">
                <label>Current Industry</label>
                <input type="text" id="currentIndustry" placeholder="Healthcare Services">
            </div>
            <div class="input-group">
                <label>Usual Industry</label>
                <input type="text" id="usualIndustry" placeholder="Healthcare Services">
            </div>
            <div class="input-group">
                <label>Current Job Title</label>
                <input type="text" id="currentJobTitle" placeholder="Senior Marketing Manager">
            </div>
            <div class="input-group">
                <label>Current Employer Name</label>
                <input type="text" id="currentEmployerName" placeholder="Springfield Medical Center">
            </div>
            <div class="input-group">
                <label>Current Employer Phone</label>
                <input type="text" id="currentEmployerPhone" placeholder="+1-217-555-0155">
            </div>
            <div class="input-group">
                <label>Current Employer Address</label>
                <input type="text" id="currentEmployerAddress" placeholder="800 E Capitol Ave, Springfield, IL 62701">
            </div>
            <div class="input-group">
                <label>Occupational Exposure</label>
                <select id="occupationalExposure">
                    <option value="">-- Select Occupational Exposure --</option>
                    <option value="Y">Yes</option>
                    <option value="N" selected>No</option>
                    <option value="UNK">Unknown</option>
                </select>
            </div>
            <div class="input-group">
                <label>Employment Status</label>
                <select id="employmentStatus">
                    <option value="">-- Select Employment Status --</option>
                    <option value="1" selected>Employed</option>
                    <option value="2">Unemployed</option>
                    <option value="3">Not in labor force</option>
                    <option value="4">Retired</option>
                    <option value="5">Student</option>
                    <option value="UNK">Unknown</option>
                </select>
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-title"><i class="fas fa-users"></i> Guardian/Parent Information</h2>
        <div class="form-grid">
            <div class="input-group">
                <label>Guardian Name</label>
                <input type="text" id="guardianName" value="Sarah Michelle Johnson">
            </div>
            <div class="input-group">
                <label>Guardian Phone</label>
                <input type="text" id="guardianPhone" value="+1-555-234-5678">
            </div>
            <div class="input-group">
                <label>Guardian Email</label>
                <input type="email" id="guardianEmail" value="sarah.johnson@email.com">
            </div>
            <div class="input-group">
                <label>Guardian Address</label>
                <input type="text" id="guardianAddress" value="1247 Maple Street">
            </div>
            <div class="input-group">
                <label>Guardian City</label>
                <input type="text" id="guardianCity" value="Springfield">
            </div>
            <div class="input-group">
                <label>Guardian State</label>
                <input type="text" id="guardianState" value="IL">
            </div>
            <div class="input-group">
                <label>Guardian ZIP Code</label>
                <input type="text" id="guardianZip" value="62701">
            </div>
            <div class="input-group">
                <label>Guardian Relationship Code</label>
                <select id="guardianCode">
                    <option value="MTH">Mother</option>
                    <option value="FTH">Father</option>
                    <option value="GRMTH">Grandmother</option>
                    <option value="GRFTH">Grandfather</option>
                    <option value="GUARD">Guardian</option>
                    <option value="O">Other</option>
                </select>
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-title"><i class="fas fa-user-md"></i> Provider Information</h2>
        <div class="form-grid">
            <div class="input-group">
                <label>Provider ID</label>
                <input type="text" id="providerId" value="1234567890">
            </div>
            <div class="input-group">
                <label>Provider Name</label>
                <input type="text" id="providerName" value="Dr Royce Hemlock">
            </div>
            <div class="input-group">
                <label>Provider Phone</label>
                <input type="text" id="providerPhone" value="+1-555-777-0123">
            </div>
            <div class="input-group">
                <label>Provider Email</label>
                <input type="email" id="providerEmail" value="dr.hemlock@grmfc.gc.example.com">
            </div>
            <div class="input-group">
                <label>Provider Fax</label>
                <input type="text" id="providerFax" value="+1-555-777-0124">
            </div>
            <div class="input-group">
                <label>Facility ID</label>
                <input type="text" id="facilityId" value="FAC-987654321">
            </div>
            <div class="input-group">
                <label>Facility Name</label>
                <input type="text" id="facilityName" value="Grand Republic Medical Facility Clinic">
            </div>
            <div class="input-group">
                <label>Facility Address</label>
                <input type="text" id="facilityAddress" value="500 Republica Medical Plaza, Suite 1000">
            </div>
            <div class="input-group">
                <label>Facility Type Code</label>
                <select id="facilityTypeCode">
                    <option value="OF">Outpatient Facility</option>
                    <option value="HOSP">Hospital</option>
                    <option value="COMM">Community Hospital</option>
                    <option value="PROFF">Provider's Office</option>
                </select>
            </div>
            <div class="input-group">
                <label>Organization Name</label>
                <input type="text" id="organizationName" value="Grand Republic Medical Corporation">
            </div>
            <div class="input-group">
                <label>Organization ID</label>
                <input type="text" id="organizationId" value="ORG-123456789">
            </div>
            <div class="input-group">
                <label>Organization Phone</label>
                <input type="text" id="organizationPhone" value="+1-555-777-1000">
            </div>
            <div class="input-group">
                <label>Organization Email</label>
                <input type="email" id="organizationEmail" value="info@grmfc.gc.example.com">
            </div>
            <div class="input-group">
                <label>Organization Fax</label>
                <input type="text" id="organizationFax" value="+1-555-777-1001">
            </div>
            <div class="input-group">
                <label>Organization Address</label>
                <input type="text" id="organizationAddress" value="500 Republica Medical Plaza">
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-title"><i class="fas fa-hospital"></i> Encounter Information</h2>
        <div class="form-grid">
            <div class="input-group">
                <label>Encounter ID</label>
                <input type="text" id="encounterId" value="9937015">
            </div>
            <div class="input-group">
                <label>Encounter Type</label>
                <input type="text" id="encounterType" value="AMB">
            </div>
            <div class="input-group">
                <label>Encounter Date</label>
                <input type="datetime-local" id="encounterDate" value="2024-06-15T08:00">
            </div>
            <div class="input-group">
                <label>Encounter End Date</label>
                <input type="datetime-local" id="encounterEndDate" value="2024-06-15T17:00">
            </div>
            <div class="input-group">
                <label>Encounter Disposition</label>
                <select id="encounterDisposition">
                    <option value="01">Routine discharge/release to home or self care</option>
                    <option value="02">Discharge/transfer to another short term hospital</option>
                    <option value="03">Discharge/transfer to skilled nursing facility</option>
                    <option value="04">Discharge/transfer to an intermediate care facility</option>
                    <option value="05">Discharge/transfer to another type of institution</option>
                    <option value="06">Discharge/transfer to home under care of organized home health service
                    </option>
                    <option value="07">Left against medical advice or discontinued care</option>
                    <option value="20">Expired</option>
                </select>
            </div>
            <div class="input-group textarea-group">
                <label>Chief Complaint</label>
                <textarea id="chiefComplaint">fever, cough, exposure to COVID-19 hot zone</textarea>
            </div>
            <div class="input-group textarea-group">
                <label>History of Present Illness</label>
                <textarea
                    id="presentIllness">The patient initially presented with difficulty breathing and fever. Patient disclosed recent travel to a known COVID-19 hot zone.</textarea>
            </div>
            <div class="input-group textarea-group">
                <label>Reason for Visit</label>
                <textarea id="reasonForVisit">Routine follow-up visit and COVID-19 screening due to exposure</textarea>
            </div>
            <div class="input-group textarea-group">
                <label>Past Medical History</label>
                <textarea id="pastMedicalHistory">No significant past medical history. No known allergies.</textarea>
            </div>
            <div class="input-group textarea-group">
                <label>Review of Systems</label>
                <textarea
                    id="reviewOfSystems">Patient reports fever, fatigue, and mild cough. Denies chest pain, shortness of breath at rest.</textarea>
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-title"><i class="fas fa-stethoscope"></i> Diagnoses with RCTC Trigger Codes</h2>

        <div>
            <div class="diagnosis-evidence-controls">
                <button class="btn btn-primary" type="button" onclick="addDiagnosisEvidence()">‚ûï Add
                    Diagnosis</button>
            </div>

            <div id="diagnosisEvidenceList"></div>

            <template id="diagnosisEvidenceTemplate">
                <div class="diagnosis-evidence-row">
                    <h4>Diagnosis Entry</h4>
                    <div class="form-grid">
                        <div class="input-group">
                            <label>Diagnosis Code <span class="trigger-indicator">RCTC TRIGGER</span></label>
                            <div class="code-search">
                                <input type="text" class="de-diagnosis-code" value="67531005">
                                <button class="btn btn-secondary" type="button"
                                    onclick="searchRCTCForDiagnosis(this)">üîç</button>
                            </div>
                            <div class="de-diagnosis-code-results search-results"></div>
                        </div>

                        <div class="input-group">
                            <label>Diagnosis Name</label>
                            <div class="code-search">
                                <input type="text" class="de-diagnosis-name" placeholder="Down syndrome (disorder)">
                                <button class="btn btn-secondary" type="button"
                                    onclick="searchRCTCForDiagnosisByName(this)">üîç</button>
                            </div>
                            <div class="de-diagnosis-name-results search-results"></div>
                        </div>

                        <div class="input-group">
                            <label>Date of Diagnosis</label>
                            <input type="datetime-local" class="de-diagnosis-date" value="2024-06-15T12:00">
                        </div>

                        <div class="input-group">
                            <label>Date of Onset</label>
                            <input type="datetime-local" class="de-onset-date" value="2024-06-15T12:00">
                        </div>

                        <div class="input-group">
                            <label>Status</label>
                            <select class="de-status">
                                <option value="completed" selected>Completed</option>
                                <option value="active">Active</option>
                                <option value="resolved">Resolved</option>
                            </select>
                        </div>

                        <div>
                            <button class="btn btn-warning" type="button" onclick="removeDiagnosisEvidence(this)">üóëÔ∏è
                                Remove</button>
                        </div>
                    </div>
                </div>
            </template>
        </div>
    </div>

    <!-- Problems Section -->
    <div class="section">
        <h2 class="section-title"><i class="fas fa-exclamation-circle"></i> Problems</h2>

        <div>
            <div class="problem-evidence-controls">
                <button class="btn btn-primary" type="button" onclick="addProblemEvidence()">‚ûï Add Problem</button>
            </div>

            <div id="problemEvidenceList"></div>

            <template id="problemEvidenceTemplate">
                <div class="problem-evidence-row">
                    <h4>Problem Entry</h4>
                    <div class="form-grid">
                        <div class="input-group">
                            <label>Problem Code</label>
                            <div class="code-search">
                                <input type="text" class="pe-problem-code" placeholder="805002">
                                <button class="btn btn-secondary" type="button"
                                    onclick="searchSNOMEDForProblem(this)">üîç</button>
                            </div>
                            <div class="pe-problem-code-results search-results"></div>
                        </div>

                        <div class="input-group">
                            <label>Problem Name</label>
                            <div class="code-search">
                                <input type="text" class="pe-problem-name" placeholder="Pneumoconiosis">
                                <button class="btn btn-secondary" type="button"
                                    onclick="searchSNOMEDForProblemByName(this)">üîç</button>
                            </div>
                            <div class="pe-problem-name-results search-results"></div>
                        </div>

                        <div class="input-group">
                            <label>Problem Onset Date</label>
                            <input type="datetime-local" class="pe-onset-date" value="2024-06-15T12:00">
                        </div>

                        <div class="input-group">
                            <label>Concern Status</label>
                            <select class="pe-concern-status">
                                <option value="active" selected>Active</option>
                                <option value="completed">Completed</option>
                            </select>
                        </div>

                        <div>
                            <button class="btn btn-warning" type="button" onclick="removeProblemEvidence(this)">üóëÔ∏è
                                Remove</button>
                        </div>
                    </div>
                </div>
            </template>
        </div>
    </div>

    <!-- Lab Orders and Results Section -->
    <div class="section">
        <h2 class="section-title"><i class="fas fa-vial"></i> Lab Orders and Results</h2>

        <div>
            <div class="lab-evidence-controls">
                <button class="btn btn-primary" type="button" onclick="addLabEvidence()">‚ûï Add Lab Order and
                    Result</button>
            </div>

            <!-- ‚îÄ‚îÄ Results Providers (applies to *all* result observations) ‚îÄ‚îÄ -->
            <div class="subsection">
                <h4>Performing Laboratory & Ordering Physician</h4>
                <div class="form-grid">
                    <!-- Performing lab (organization) -->
                    <div class="input-group">
                        <label>Performing Lab ‚Ä¢ CLIA </label>
                        <input type="text" id="resultLabCLIA" value="12D3456789">
                    </div>
                    <div class="input-group">
                        <label>Performing Lab ‚Ä¢ Name </label>
                        <input type="text" id="resultLabName" value="Good Health Lab">
                    </div>

                    <!-- Resulting performer (person) -->
                    <div class="input-group">
                        <label>Resulting Performer ‚Ä¢ NPI </label>
                        <input type="text" id="resultPerformerNPI" inputmode="numeric" pattern="\d{10}">
                    </div>
                    <div class="input-group">
                        <label>Resulting Performer ‚Ä¢ First </label>
                        <input type="text" id="resultPerformerGiven">
                    </div>
                    <div class="input-group">
                        <label>Resulting Performer ‚Ä¢ Last </label>
                        <input type="text" id="resultPerformerFamily">
                    </div>

                    <!-- Ordering provider (author) -->
                    <div class="input-group">
                        <label>Ordering Provider ‚Ä¢ NPI </label>
                        <input type="text" id="resultOrderingNPI" inputmode="numeric" pattern="\d{10}">
                    </div>
                    <div class="input-group">
                        <label>Ordering Provider ‚Ä¢ First </label>
                        <input type="text" id="resultOrderingGiven">
                    </div>
                    <div class="input-group">
                        <label>Ordering Provider ‚Ä¢ Last</label>
                        <input type="text" id="resultOrderingFamily">
                    </div>
                </div>
            </div>

            <div id="labEvidenceList"></div>

            <template id="labEvidenceTemplate">
                <div class="lab-evidence-row">
                    <h4>Lab Order and Result Entry</h4>
                    <div class="form-grid">
                        <!-- Order Information -->
                        <div class="input-group">
                            <label>Order Code (LOINC) <span class="trigger-indicator">RCTC TRIGGER</span></label>
                            <div class="code-search">
                                <input type="text" class="le-order-code" value="">
                                <button class="btn btn-secondary" type="button"
                                    onclick="searchRCTCForLabOrder(this)">üîç</button>
                            </div>
                            <div class="le-order-code-results search-results"></div>
                        </div>
                        <div class="input-group">
                            <label>Order Name</label>
                            <div class="code-search">
                                <input type="text" class="le-order-name" value="SARS-like Coronavirus N gene">
                                <button class="btn btn-secondary" type="button"
                                    onclick="searchRCTCForLabOrderByName(this)">üîç</button>
                            </div>
                            <div class="le-order-name-results search-results"></div>
                        </div>
                        <div class="input-group">
                            <label>Order ID</label>
                            <input type="text" class="le-order-id" value="ORD-2024-001">
                        </div>
                        <div class="input-group">
                            <label>Order Time</label>
                            <input type="datetime-local" class="le-order-time" value="2024-06-15T12:00">
                        </div>

                        <!-- Test/Result Information -->
                        <div class="input-group">
                            <label>Test Code (LOINC) <span class="trigger-indicator">RCTC TRIGGER</span></label>
                            <div class="code-search">
                                <input type="text" class="le-test-code" value="">
                                <button class="btn btn-secondary" type="button"
                                    onclick="searchRCTCForTest(this)">üîç</button>
                            </div>
                            <div class="le-test-code-results search-results"></div>
                        </div>
                        <div class="input-group">
                            <label>Test Name</label>
                            <div class="code-search">
                                <input type="text" class="le-test-name" value="SARS-like Coronavirus N gene">
                                <button class="btn btn-secondary" type="button"
                                    onclick="searchRCTCForTestByName(this)">üîç</button>
                            </div>
                            <div class="le-test-name-results search-results"></div>
                        </div>

                        <!-- Result Value Type Selector -->
                        <div class="input-group">
                            <label>Result Kind</label>
                            <select class="le-value-kind" onchange="toggleValueEditors(this)">
                                <option value="coded" selected>Coded (organism/substance)</option>
                                <option value="quantity">Quantity</option>
                                <option value="text">Text</option>
                            </select>
                        </div>

                        <!-- Coded Value (SNOMED CT) -->
                        <div class="input-group le-coded">
                            <label>Organism/Substance Code (SNOMED CT)</label>
                            <div class="code-search">
                                <input type="text" class="le-value-code" value="840539006">
                                <button class="btn btn-secondary" type="button"
                                    onclick="searchRCTCForOrganism(this)">üîç</button>
                            </div>
                            <div class="le-value-code-results search-results"></div>
                        </div>
                        <div class="input-group le-coded">
                            <label>Organism/Substance Name</label>
                            <div class="code-search">
                                <input type="text" class="le-value-name" value="Disease caused by 2019-nCoV">
                                <button class="btn btn-secondary" type="button"
                                    onclick="searchRCTCForOrganismByName(this)">üîç</button>
                            </div>
                            <div class="le-value-name-results search-results"></div>
                        </div>

                        <!-- Quantity Value -->
                        <div class="input-group le-qty hidden">
                            <label>Value</label>
                            <input type="number" step="0.01" class="le-qty-value" value="ex. 100">
                        </div>
                        <div class="input-group le-qty hidden">
                            <label>Unit</label>
                            <input type="text" class="le-qty-unit" value="[iU]/mL">
                        </div>

                        <!-- Text Value -->
                        <div class="input-group le-text hidden">
                            <label>Text Result</label>
                            <input type="text" class="le-text-value" value="Detected">
                        </div>

                        <!-- Timing/Status/Interpretation -->
                        <div class="input-group">
                            <label>Result Time</label>
                            <input type="datetime-local" class="le-time" value="2024-06-15T12:00">
                        </div>
                        <div class="input-group">
                            <label>Status</label>
                            <select class="le-status">
                                <option value="completed" selected>completed</option>
                                <option value="active">active</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>Interpretation</label>
                            <select class="le-interpretation">
                                <option value=""></option>
                                <option value="A">Abnormal</option>
                                <option value="N">Normal</option>
                                <option value="H">High</option>
                                <option value="L">Low</option>
                                <option value="HH">Critical high</option>
                                <option value="LL">Critical low</option>
                            </select>
                        </div>

                        <!-- Reference Range -->
                        <div class="input-group">
                            <label>Reference Range</label>
                            <input type="text" class="le-reference-range" value="2.5-15.0 ng/mL">
                        </div>

                        <div>
                            <button class="btn btn-warning" type="button" onclick="removeLabEvidence(this)">üóëÔ∏è
                                Remove</button>
                        </div>
                    </div>
                </div>
            </template>
        </div>
    </div>

    <!-- ‚ñë‚ñë‚ñë  MEDICATIONS  ‚ñë‚ñë‚ñë================================================ -->
    <div class="section">
        <h2 class="section-title"><i class="fas fa-pills"></i> Medications</h2>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!--    ADMINISTERED MEDICATIONS REPEATER (NEW PATTERN)     -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

        <div>
            <div class="medication-administered-evidence-controls">
                <button class="btn btn-primary" type="button" onclick="addAdministeredMedication()">‚ûï Add Administered Medication</button>
            </div>

            <!-- Administering Provider (Global - applies to ALL administered meds unless overridden) -->
            <div class="subsection">
                <h4>Administering Provider (Global)</h4>
                <p style="color: var(--muted); font-size: 0.9em; margin-bottom: 16px;">
                    This provider will be used for all administered medications unless overridden in individual medication entries.
                </p>
                <div class="form-grid">
                    <div class="input-group">
                        <label>Administering Provider NPI</label>
                        <input type="text" id="administeringProviderNPI" inputmode="numeric" pattern="\d{10}"
                            value="1234567890">
                    </div>

                    <div class="input-group">
                        <label>First</label>
                        <input type="text" id="administeringProviderGiven" value="Je Suis">
                    </div>

                    <div class="input-group">
                        <label>Last</label>
                        <input type="text" id="administeringProviderFamily" value="M√©decin">
                    </div>

                    <div class="input-group">
                        <label>Phone (opt)</label>
                        <input type="tel" id="administeringProviderPhone" value="555-555-5555">
                    </div>

                    <div class="input-group">
                        <label>Organization (opt)</label>
                        <input type="text" id="administeringProviderOrgName">
                    </div>

                    <div class="input-group">
                        <label>Org ID (extension) (opt)</label>
                        <input type="text" id="administeringProviderOrgId" value="123456789">
                    </div>

                    <div class="input-group">
                        <label>Org ID Root (OID) (opt)</label>
                        <input type="text" id="administeringProviderOrgIdRoot" value="2.16.840.1.113883.19">
                    </div>
                </div>
            </div>

            <div id="administeredMedicationList"></div>

            <template id="administeredMedicationTemplate">
                <div class="medication-administered-evidence-row">
                    <h4>Administered Medication Entry</h4>
                    <div class="form-grid">
                        <!-- Core Medication Fields -->
                        <div class="input-group">
                            <label>Medication Code (RxNorm) <span class="help-tooltip" title="Search RCTC (Reportable Condition Trigger Codes) for trigger codes">üîç RCTC</span></label>
                            <div class="code-search">
                                <input type="text" class="ame-medication-code me-medication-code" placeholder="42946" value="">
                                <button type="button" class="btn btn-secondary" onclick="searchRCTCCodesForMedication(this, 'code')">üîç</button>
                            </div>
                            <div class="ame-code-search-results search-results"></div>
                        </div>

                        <div class="input-group">
                            <label>Medication Name <span class="help-tooltip" title="Search RCTC by medication name">üîç RCTC</span></label>
                            <div class="code-search">
                                <input type="text" class="ame-medication-name" placeholder="Folic acid" value="">
                                <button type="button" class="btn btn-secondary" onclick="searchRCTCCodesForMedication(this, 'name')">üîç</button>
                            </div>
                            <div class="ame-name-search-results search-results"></div>
                        </div>

                        <div class="input-group">
                            <label>Administration ID</label>
                            <input type="text" class="ame-administration-id" placeholder="MED-2024-001" value="">
                        </div>

                        <div class="input-group">
                            <label>Administration Time</label>
                            <input type="datetime-local" class="ame-administration-time" value="">
                        </div>

                        <div class="input-group">
                            <label>Status</label>
                            <select class="ame-status">
                                <option value="completed" selected>Completed</option>
                                <option value="active">Active</option>
                                <option value="suspended">Suspended</option>
                                <option value="aborted">Aborted</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label>Route</label>
                            <select class="ame-route">
                                <option value="PO">Oral</option>
                                <option value="IV">Intravenous</option>
                                <option value="IM">Intramuscular</option>
                                <option value="SC">Subcutaneous</option>
                                <option value="SL">Sublingual</option>
                                <option value="TOP">Topical</option>
                                <option value="INH">Inhalation</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label>Dose Amount</label>
                            <input type="number" step="0.01" class="ame-dose-value" placeholder="0.4" value="">
                        </div>

                        <div class="input-group">
                            <label>Dose Unit</label>
                            <select class="ame-dose-unit">
                                <option value="mg">mg</option>
                                <option value="mcg">mcg</option>
                                <option value="g">g</option>
                                <option value="mL">mL</option>
                                <option value="1">each / tablet</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label>Volume Amount (optional)</label>
                            <input type="number" step="0.01" class="ame-volume-value" placeholder="0.5" value="">
                        </div>

                        <div class="input-group">
                            <label>Volume Unit (optional)</label>
                            <select class="ame-volume-unit">
                                <option value=""></option>
                                <option value="mL">mL</option>
                                <option value="L">L</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label><input type="checkbox" class="ame-negated"> NOT given (negationInd)</label>
                        </div>

                        <!-- Performer (Administering Provider) Fields - OPTIONAL OVERRIDE -->
                        <div class="input-group" style="grid-column: 1 / -1; margin-top: 16px;">
                            <label style="font-weight: 700; color: var(--accent);">Performer Override (Optional)</label>
                            <small style="color: var(--muted);">Leave blank to use global administering provider above. Performer = who administered. Author will auto-populate from performer or global provider.</small>
                        </div>

                        <div class="input-group">
                            <label>Performer NPI</label>
                            <input type="text" class="ame-performer-npi" placeholder="1234567890" value="">
                        </div>

                        <div class="input-group">
                            <label>Performer Given Name</label>
                            <input type="text" class="ame-performer-given" placeholder="First Name" value="">
                        </div>

                        <div class="input-group">
                            <label>Performer Middle Name (optional)</label>
                            <input type="text" class="ame-performer-middle" placeholder="Middle Name" value="">
                        </div>

                        <div class="input-group">
                            <label>Performer Family Name</label>
                            <input type="text" class="ame-performer-family" placeholder="Last Name" value="">
                        </div>

                        <div class="input-group">
                            <label>Performer Phone</label>
                            <input type="tel" class="ame-performer-phone" placeholder="555-555-5555" value="">
                        </div>

                        <!-- Remove Button -->
                        <div style="grid-column: 1 / -1; margin-top: 16px;">
                            <button class="btn btn-warning" type="button" onclick="removeAdministeredMedication(this)">üóëÔ∏è Remove Medication</button>
                        </div>
                    </div>
                </div>
            </template>
        </div>

        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!--   LEGACY ADMINISTERED MEDICATIONS (FOR BACKWARD COMPAT) -->
        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <!-- Legacy Administered Medication and Planned Medication fields removed -->
        <!-- Administered medications now use repeater pattern above -->
        <!-- Planned medications were never implemented in CDA generation -->
    </div>
    <!-- ‚ñë‚ñë‚ñë=============================================================== -->

    <div class="section">
        <h2 class="section-title"><i class="fas fa-syringe"></i> Immunizations</h2>

        <!-- Immunization Repeater -->
        <div style="margin-top: 32px;">
            <div class="immunization-evidence-controls">
                <button class="btn btn-primary" type="button" onclick="addImmunization()">‚ûï Add Immunization</button>
            </div>

            <div id="immunizationList"></div>

            <!-- Immunization Template -->
            <template id="immunizationTemplate">
                <div class="immunization-row">
                    <h4>Immunization Entry</h4>
                    <div class="form-grid">
                        <!-- Core Immunization Fields -->
                        <div class="input-group">
                            <label>Vaccine Code (CVX)</label>
                            <input type="text" class="imm-vaccine-code" placeholder="08" value="">
                        </div>

                        <div class="input-group">
                            <label>Vaccine Name</label>
                            <input type="text" class="imm-vaccine-name" placeholder="Hep B, adolescent or pediatric" value="">
                        </div>

                        <div class="input-group">
                            <label>Immunization ID</label>
                            <input type="text" class="imm-immunization-id" placeholder="IMM-2024-001" value="">
                        </div>

                        <div class="input-group">
                            <label>Immunization Date</label>
                            <input type="datetime-local" class="imm-immunization-date" value="">
                        </div>

                        <div class="input-group">
                            <label>Status</label>
                            <select class="imm-status">
                                <option value="completed" selected>Completed</option>
                                <option value="not-done">Not Done</option>
                                <option value="refused">Refused</option>
                                <option value="unknown">Unknown</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label>Route</label>
                            <select class="imm-route">
                                <option value="IM" selected>Intramuscular (IM)</option>
                                <option value="SC">Subcutaneous (SC)</option>
                                <option value="ID">Intradermal (ID)</option>
                                <option value="PO">Oral (PO)</option>
                                <option value="IN">Intranasal (IN)</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label>Dose Amount</label>
                            <input type="number" step="0.01" class="imm-dose-value" placeholder="0.5" value="">
                        </div>

                        <div class="input-group">
                            <label>Dose Unit</label>
                            <select class="imm-dose-unit">
                                <option value="mL" selected>mL</option>
                                <option value="mcg">mcg</option>
                                <option value="mg">mg</option>
                                <option value="1">each / dose</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label>Lot Number</label>
                            <input type="text" class="imm-lot-number" placeholder="ABC12345" value="">
                        </div>

                        <div class="input-group">
                            <label>Manufacturer</label>
                            <input type="text" class="imm-manufacturer" placeholder="Merck & Co." value="">
                        </div>

                        <!-- Performer (Administering Provider) Fields - OPTIONAL OVERRIDE -->
                        <div class="input-group" style="grid-column: 1 / -1; margin-top: 16px;">
                            <label style="font-weight: 700; color: var(--accent);">Performer Override (Optional)</label>
                            <small style="color: var(--muted);">Leave blank to use global administering provider. Performer = who administered. Author will auto-populate from performer or global provider.</small>
                        </div>

                        <div class="input-group">
                            <label>Performer NPI</label>
                            <input type="text" class="imm-performer-npi" placeholder="1234567890" value="">
                        </div>

                        <div class="input-group">
                            <label>Performer Given Name</label>
                            <input type="text" class="imm-performer-given" placeholder="First Name" value="">
                        </div>

                        <div class="input-group">
                            <label>Performer Middle Name (optional)</label>
                            <input type="text" class="imm-performer-middle" placeholder="Middle Name" value="">
                        </div>

                        <div class="input-group">
                            <label>Performer Family Name</label>
                            <input type="text" class="imm-performer-family" placeholder="Last Name" value="">
                        </div>

                        <div class="input-group">
                            <label>Performer Phone</label>
                            <input type="tel" class="imm-performer-phone" placeholder="555-555-5555" value="">
                        </div>

                        <!-- Remove Button -->
                        <div style="grid-column: 1 / -1; margin-top: 16px;">
                            <button class="btn btn-warning" type="button" onclick="removeImmunization(this)">üóëÔ∏è Remove Immunization</button>
                        </div>
                    </div>
                </div>
            </template>
        </div>

        <!-- Legacy immunization fields removed -->
        <!-- Immunizations now use repeater pattern above -->
    </div>

    <div class="section">
        <h2 class="section-title"><i class="fas fa-baby"></i> Pregnancy Information</h2>
        <div class="form-grid">
            <div class="input-group">
                <label>Pregnancy Status</label>
                <select id="pregnancyStatus">
                    <option value="77386006" selected>Pregnant</option>
                    <option value="60001007">Not pregnant</option>
                    <option value="102874004">Possible pregnancy</option>
                    <option value="261665006">Unknown</option>
                </select>
            </div>
            <div class="input-group">
                <label>Pregnancy Effective Time</label>
                <input type="datetime-local" id="pregnancyEffectiveTime" placeholder="Date of assessment"
                    value="2024-06-15T10:00">
            </div>
            <div class="input-group">
                <label>Estimated Delivery Date</label>
                <input type="datetime-local" id="estimatedDeliveryDate" placeholder="Expected delivery date"
                    value="2024-06-15T00:00">
            </div>
            <div class="input-group">
                <label>Pregnancy Determination Method</label>
                <select id="pregnancyDeterminationMethod">
                    <option value="169560004">Urine pregnancy test</option>
                    <option value="167252002">Serum pregnancy test</option>
                    <option value="12611008" selected>Ultrasound examination</option>
                    <option value="271900007">Patient reported</option>
                </select>
            </div>
            <div class="input-group">
                <label>Gestational Age (weeks)</label>
                <input type="text" id="gestationalAge" placeholder="e.g., 12" value="39">
            </div>
            <div class="input-group">
                <label>Last Menstrual Period</label>
                <input type="datetime-local" id="lastMenstrualPeriod" placeholder="Date of LMP"
                    value="2023-09-06T00:00">
            </div>
            <div class="input-group">
                <label>Pregnancy Outcome</label>
                <select id="pregnancyOutcome">
                    <option value="281050002" selected>Live birth</option>
                    <option value="237364002">Stillbirth</option>
                    <option value="17369002">Miscarriage</option>
                    <option value="69422002">Elective termination</option>
                    <option value="N/A">Not applicable</option>
                </select>
            </div>
            <div class="input-group">
                <label>Postpartum Status</label>
                <select id="postpartumStatus">
                    <option value="255410009" selected>Postpartum</option>
                    <option value="255409004">Not postpartum</option>
                    <option value="261665006">Unknown</option>
                </select>
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-title"><i class="fas fa-plane"></i> Travel History</h2>
        <div class="form-grid">
            <div class="input-group">
                <label>Travel Start Date</label>
                <input type="datetime-local" id="travelStartDate" value="2024-05-15T00:00">
            </div>
            <div class="input-group">
                <label>Travel End Date</label>
                <input type="datetime-local" id="travelEndDate" value="2024-05-20T00:00">
            </div>
            <div class="input-group">
                <label>Travel Location</label>
                <input type="text" id="travelLocation" value="Chicago, Illinois">
            </div>
            <div class="input-group">
                <label>Travel Location Code</label>
                <input type="text" id="travelLocationCode" value="IL">
            </div>
            <div class="input-group">
                <label>Travel Address</label>
                <input type="text" id="travelAddress" value="123 Oak Street, Springfield, IL 62701">
            </div>
            <div class="input-group">
                <label>Purpose of Travel</label>
                <select id="purposeOfTravel">
                    <option value="">-- Select Purpose of Travel --</option>
                    <option value="224930009">Business</option>
                    <option value="289049007" selected>Leisure</option>
                    <option value="385731004">Medical</option>
                    <option value="224930009">Educational</option>
                    <option value="O">Other</option>
                </select>
            </div>
            <div class="input-group">
                <label>Transportation Type</label>
                <select id="transportationType">
                    <option value="">-- Select Transportation Type --</option>
                    <option value="73957001">Air transport</option>
                    <option value="49122002" selected>Ground transport</option>
                    <option value="272125009">Water transport</option>
                    <option value="34965002">Public transport</option>
                    <option value="71783008">Private transport</option>
                </select>
            </div>
            <div class="input-group">
                <label>Transportation Details</label>
                <textarea
                    id="transportationDetails">Personal vehicle - 2022 Honda Pilot, License plate: ABC-1234</textarea>
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-title"><i class="fas fa-microscope"></i> Specimen Information</h2>
        <div class="form-grid">
            <div class="input-group">
                <label>Specimen 1 Source</label>
                <select id="specimen1Source">
                    <option value="258500001">Nasopharyngeal swab</option>
                    <option value="461911000124106">Oropharyngeal swab</option>
                    <option value="258580003" selected>Whole blood sample</option>
                    <option value="122555007">Venous blood sample</option>
                    <option value="309051001">Body fluid sample</option>
                    <option value="119295008">Specimen obtained by aspiration</option>
                </select>
            </div>
            <div class="input-group">
                <label>Specimen 1 Type</label>
                <input type="text" id="specimen1Type" placeholder="e.g., Swab" value="Whole blood">
            </div>
            <div class="input-group">
                <label>Specimen 1 ID</label>
                <input type="text" id="specimen1Id" placeholder="e.g., SPEC-001" value="NB-BLOOD-20240615-001">
            </div>
            <div class="input-group">
                <label>Collection Date 1</label>
                <input type="datetime-local" id="collection1Date" placeholder="e.g., 20250216110000"
                    value="2024-06-15T08:30">
            </div>
            <div class="input-group">
                <label>Specimen 2 Source</label>
                <select id="specimen2Source">
                    <option value="258500001">Nasopharyngeal swab</option>
                    <option value="461911000124106">Oropharyngeal swab</option>
                    <option value="258580003">Whole blood sample</option>
                    <option value="122555007">Venous blood sample</option>
                    <option value="309051001" selected>Body fluid sample</option>
                    <option value="119295008">Specimen obtained by aspiration</option>
                </select>
            </div>
            <div class="input-group">
                <label>Specimen 2 Type</label>
                <input type="text" id="specimen2Type" placeholder="e.g., Blood" value="Cerebrospinal fluid">
            </div>
            <div class="input-group">
                <label>Specimen 2 ID</label>
                <input type="text" id="specimen2Id" placeholder="e.g., SPEC-002" value="NB-CSF-20240615-001">
            </div>
            <div class="input-group">
                <label>Collection Date 2</label>
                <input type="datetime-local" id="collection2Date" placeholder="e.g., 20250216120000"
                    value="2024-06-15T09:30">
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-title"><i class="fas fa-chart-line"></i> Additional Clinical Data</h2>
        <div class="form-grid">
            <div class="input-group">
                <label>Temperature (¬∞F)</label>
                <input type="text" id="temperature" placeholder="e.g., 98.6" value="97.8">
            </div>
            <div class="input-group">
                <label>Blood Pressure (mmHg)</label>
                <input type="text" id="bloodPressure" placeholder="e.g., 120/80" value="65/42">
            </div>
            <div class="input-group">
                <label>Heart Rate (bpm)</label>
                <input type="text" id="heartRate" placeholder="e.g., 72" value="145">
            </div>
            <div class="input-group">
                <label>Respiratory Rate (breaths/min)</label>
                <input type="text" id="respiratoryRate" placeholder="e.g., 16" value="38">
            </div>
            <div class="input-group">
                <label>Oxygen Saturation (%)</label>
                <input type="text" id="oxygenSaturation" placeholder="e.g., 98" value="97">
            </div>
            <div class="input-group">
                <label>Weight (lbs)</label>
                <input type="text" id="weight" placeholder="e.g., 150" value="6.2">
            </div>
            <div class="input-group">
                <label>Height (inches)</label>
                <input type="text" id="height" placeholder="e.g., 68" value="19.5">
            </div>
            <div class="input-group">
                <label>BMI</label>
                <input type="text" id="bmi" placeholder="e.g., 22.8" value="13.2">
            </div>
            <div class="input-group">
                <label>Therapeutic Response</label>
                <select id="therapeuticResponse">
                    <option value="182840001" selected>Good response</option>
                    <option value="182841002">Poor response</option>
                    <option value="182842009">No response</option>
                    <option value="182843004">Partial response</option>
                    <option value="385655000">Not applicable</option>
                </select>
            </div>
            <div class="input-group">
                <label>Homeless Status</label>
                <select id="homelessStatus">
                    <option value="105526001">Homeless</option>
                    <option value="105529008" selected>Not homeless</option>
                    <option value="261665006">Unknown</option>
                </select>
            </div>
            <div class="input-group">
                <label>Congregate Living</label>
                <select id="congregateLiving">
                    <option value="Y">Yes</option>
                    <option value="N" selected>No</option>
                    <option value="UNK">Unknown</option>
                </select>
            </div>
            <div class="input-group">
                <label>Congregate Living Type</label>
                <select id="congregateLivingType">
                    <option value="224683003">Nursing home</option>
                    <option value="42665001">School</option>
                    <option value="264362003">Prison</option>
                    <option value="257656006">Dormitory</option>
                    <option value="224891009">Shelter</option>
                    <option value="O" selected>Other</option>
                </select>
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-title"><i class="fas fa-procedures"></i> Procedures</h2>

        <!-- Procedure Repeater -->
        <div>
            <div class="procedure-evidence-controls">
                <button class="btn btn-primary" type="button" onclick="addProcedure()">‚ûï Add Procedure</button>
            </div>

            <div id="procedureList"></div>

            <!-- Procedure Template -->
            <template id="procedureTemplate">
            <div class="procedure-row">
                <h4>Procedure Entry</h4>
                <div class="form-grid">
                    <!-- Core Procedure Fields -->
                    <div class="input-group">
                        <label>Procedure Code <span class="help-tooltip" title="Search RCTC (Reportable Condition Trigger Codes) for trigger codes">üîç RCTC</span></label>
                        <div class="code-search">
                            <input type="text" class="proc-procedure-code" placeholder="80146002" value="">
                            <button type="button" class="btn btn-secondary" onclick="searchRCTCCodesForProcedure(this)">üîç</button>
                        </div>
                        <div class="proc-code-search-results search-results"></div>
                    </div>

                    <div class="input-group">
                        <label>Procedure Name</label>
                        <input type="text" class="proc-procedure-name" placeholder="Excision of spinal lesion" value="">
                    </div>

                    <div class="input-group">
                        <label>Code System</label>
                        <select class="proc-code-system">
                            <option value="2.16.840.1.113883.6.96" selected>SNOMED CT</option>
                            <option value="2.16.840.1.113883.6.1">LOINC</option>
                            <option value="2.16.840.1.113883.6.12">CPT-4</option>
                            <option value="2.16.840.1.113883.6.4">ICD10 PCS</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>Procedure ID (optional)</label>
                        <input type="text" class="proc-procedure-id" placeholder="PROC-2024-001" value="">
                    </div>

                    <div class="input-group">
                        <label>Procedure Date</label>
                        <input type="datetime-local" class="proc-procedure-date" value="">
                    </div>

                    <div class="input-group">
                        <label>Status</label>
                        <select class="proc-status">
                            <option value="completed" selected>Completed</option>
                            <option value="active">Active</option>
                            <option value="aborted">Aborted</option>
                            <option value="cancelled">Cancelled</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>Target Site Code (optional)</label>
                        <input type="text" class="proc-target-site-code" placeholder="421060004" value="">
                    </div>

                    <div class="input-group">
                        <label>Target Site Name (optional)</label>
                        <input type="text" class="proc-target-site-name" placeholder="Structure of vertebral column" value="">
                    </div>

                    <div class="input-group">
                        <label>Method Code (optional)</label>
                        <input type="text" class="proc-method-code" placeholder="" value="">
                    </div>

                    <div class="input-group">
                        <label>Method Name (optional)</label>
                        <input type="text" class="proc-method-name" placeholder="" value="">
                    </div>

                    <div class="input-group">
                        <label>Procedure Type <span class="help-tooltip"
                                title="Act: Use for general healthcare activities and administrative actions that don't fit the specific criteria for observations or procedures.

Observation: Use for diagnostic activities that gather information about the patient (lab tests, imaging, assessments) without altering their physical condition.

Procedure: Use for therapeutic interventions that alter the patient's physical condition (surgeries, treatments, manipulations).">‚ÑπÔ∏è</span></label>
                        <select class="proc-procedure-type">
                            <option value="act">Act</option>
                            <option value="observation">Observation</option>
                            <option value="procedure" selected>Procedure</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="proc-negated">
                            Negated (not performed)
                        </label>
                    </div>

                    <!-- Performer (Provider) Fields - OPTIONAL OVERRIDE -->
                    <div class="input-group" style="grid-column: 1 / -1; margin-top: 16px;">
                        <label style="font-weight: 700; color: var(--accent);">Performer Override (Optional)</label>
                        <small style="color: var(--muted);">Leave blank to use global provider. Performer = who performed the procedure.</small>
                    </div>

                    <div class="input-group">
                        <label>Performer NPI</label>
                        <input type="text" class="proc-performer-npi" placeholder="1234567890" value="">
                    </div>

                    <div class="input-group">
                        <label>Performer Given Name</label>
                        <input type="text" class="proc-performer-given" placeholder="First Name" value="">
                    </div>

                    <div class="input-group">
                        <label>Performer Middle Name (optional)</label>
                        <input type="text" class="proc-performer-middle" placeholder="Middle Name" value="">
                    </div>

                    <div class="input-group">
                        <label>Performer Family Name</label>
                        <input type="text" class="proc-performer-family" placeholder="Last Name" value="">
                    </div>

                    <div class="input-group">
                        <label>Performer Phone</label>
                        <input type="tel" class="proc-performer-phone" placeholder="555-555-5555" value="">
                    </div>

                    <!-- Remove Button -->
                    <div style="grid-column: 1 / -1; margin-top: 16px;">
                        <button class="btn btn-warning" type="button" onclick="removeProcedure(this)">üóëÔ∏è Remove Procedure</button>
                    </div>
                </div>
            </div>
            </template>
        </div>

        <!-- Legacy procedure fields removed -->
        <!-- Procedures now use repeater pattern above -->
    </div>


    <div class="section">
        <h2 class="section-title"><i class="fas fa-exclamation-triangle"></i> Emergency and Public Health</h2>
        <div class="form-grid">
            <div class="input-group">
                <label>Emergency Outbreak Information</label>
                <select id="emergencyOutbreakInfo">
                    <option value="443684005">Disease outbreak</option>
                    <option value="410546004">Public health emergency</option>
                    <option value="N/A" selected>Not applicable</option>
                    <option value="261665006">Unknown</option>
                </select>
            </div>
            <div class="input-group">
                <label>Outbreak Details</label>
                <textarea
                    id="outbreakDetails">No current outbreak or emergency situation related to this case</textarea>
            </div>
            <div class="input-group">
                <label>Exposure/Contact Information</label>
                <select id="exposureContactInfo">
                    <option value="24932003">Exposed</option>
                    <option value="84100007">Contact</option>
                    <option value="373068000" selected>No exposure</option>
                    <option value="261665006">Unknown</option>
                </select>
            </div>
            <div class="input-group">
                <label>Exposure Type</label>
                <select id="exposureType">
                    <option value="409822003">Direct contact</option>
                    <option value="417746004">Airborne</option>
                    <option value="418038007">Droplet</option>
                    <option value="447964005">Contact precaution</option>
                    <option value="OTH" selected>Other</option>
                </select>
            </div>
            <div class="input-group">
                <label>Exposure Location</label>
                <input type="text" id="exposureLocation" value="Not applicable - congenital condition">
            </div>
            <div class="input-group">
                <label>Exposure Date (YYYYMMDD)</label>
                <input type="text" id="exposureDate" value="Not applicable">
            </div>
            <div class="input-group">
                <label>Contact Person Name</label>
                <input type="text" id="contactPersonName" value="Dr. Patricia Williams, MD">
            </div>
            <div class="input-group">
                <label>Contact Person Phone</label>
                <input type="text" id="contactPersonPhone" value="+1-217-555-0199">
            </div>
            <div class="input-group">
                <label>Vaccine Credential Patient Assertion</label>
                <select id="vaccineCredentialAssertion">
                    <option value="Y">Yes</option>
                    <option value="N" selected>No</option>
                    <option value="UNK">Unknown</option>
                </select>
            </div>
            <div class="input-group">
                <label>Vaccine Card Available</label>
                <select id="vaccineCardAvailable">
                    <option value="Y">Yes</option>
                    <option value="N" selected>No</option>
                    <option value="UNK">Unknown</option>
                </select>
            </div>
            <div class="input-group">
                <label>Quarantine Status</label>
                <select id="quarantineStatus">
                    <option value="182856006">In quarantine</option>
                    <option value="182857002">Released from quarantine</option>
                    <option value="405178008" selected>Not in quarantine</option>
                    <option value="261665006">Unknown</option>
                </select>
            </div>
            <div class="input-group">
                <label>Isolation Status</label>
                <select id="isolationStatus">
                    <option value="40174006">In isolation</option>
                    <option value="182840001">Released from isolation</option>
                    <option value="385432009" selected>Not in isolation</option>
                    <option value="261665006">Unknown</option>
                </select>
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-title"><i class="fas fa-file-alt"></i> Related Document Information</h2>
        <div class="form-grid">
            <div class="input-group">
                <label>Document ID</label>
                <input type="text" id="documentId" value="10c13861-86a8-4a9a-aec6-b615921178df">
            </div>
            <div class="input-group">
                <label>Effective Time</label>
                <input type="datetime-local" id="effectiveTime" value="2025-09-26T18:05">
            </div>
            <div class="input-group">
                <label>Document Relationship Type <span class="help-tooltip"
                        title="Defines how this document relates to other documents. Use 'New Document' for standalone documents, or 'Replace/Update Document' to supersede or modify an existing document.">‚ÑπÔ∏è</span></label>
                <select id="documentRelationshipType" onchange="handleRelationshipTypeChange()">
                    <option value="NEW" selected>New Document</option>
                    <option value="RPLC">Replace/Update Document</option>
                </select>
            </div>
            <div class="input-group" id="relatedDocIdGroup" style="display: none;">
                <label>Related Document Set ID <span style="color: red;">*</span> <span class="help-tooltip"
                        title="The Set ID of the original document you are replacing/updating. This will become the Set ID for this new version. Required when relationship type is not 'New Document'.">‚ÑπÔ∏è</span></label>
                <input type="text" id="relatedDocumentId" placeholder="Enter the Set ID of the original document"
                    onchange="handleRelatedDocumentIdChange()">
            </div>
            <div class="input-group" id="setIdGroup">
                <label>Set ID <span class="help-tooltip"
                        title="Unique identifier that stays the same across all versions of the same logical document. Documents with the same Set ID represent different versions of the same document.">‚ÑπÔ∏è</span></label>
                <input type="text" id="setId" value="8d86218e-0fea-11eb-8216-a80388425cfb">
            </div>
            <div class="input-group">
                <label>Version Number <span class="help-tooltip"
                        title="Sequential number that increments with each new version of the document. Same Set ID + higher version number = newer version.">‚ÑπÔ∏è</span></label>
                <input type="text" id="versionNumber" value="3">
            </div>
            <div class="help-text">
                <h4>Document Relationship Guide:</h4>
                <ul>
                    <li><strong>New Document:</strong> Creates a standalone document with a unique Set ID and
                        version 1</li>
                    <li><strong>Replace/Update Document:</strong> Creates a new version of an existing document by
                        entering the original document's Set ID and incrementing the version number</li>
                </ul>
            </div>
        </div>
    </div>

    </div>

    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

    <!-- Application Scripts - Load in dependency order -->
    <script src="js/config.js"></script>
    <script src="js/data-transformers.js"></script>
    <script src="js/data-loaders.js"></script>
    <script src="js/form-handlers.js"></script>
    <script src="js/validation.js"></script>
    <script src="js/search-functions.js"></script>
    <script src="js/repeater-managers.js"></script>
    <script src="js/xml-builders.js"></script>
    <script src="js/rr-generator.js"></script>
    <script src="js/xslt-processor.js"></script>
    <script src="js/file-downloaders.js"></script>
    <script src="js/ui-interactions.js"></script>
    <script src="js/patient-overview.js"></script>
    <script src="js/initialization.js"></script>


    <!-- UI Enhancements - Visual overlay module -->
    <script type="module" src="js/ui-enhancements.js" defer></script>

    <!-- Reportability Engine Integration (Bundled for local file:// usage) -->
    <script src="js/reportability-engine/bundle.js"></script>

</body>

</html>